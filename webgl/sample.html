<meta charset='utf-8'>
<script src="lib/glutil.js"></script>
<script src="lib/shader.js"></script>
<script src="lib/text2img.js"></script>
<script src="effects/blur/blur.js" charset="utf-8"></script>
<script src="effects/lifegame/lifegame.js" charset="utf-8"></script>
<script src="aftereffect/square/square.js" charset="utf-8"></script>
<script src="aftereffect/sugokuiine/sugoku.js" charset="utf-8"></script>
<script>


var GL,FB;
onload=function(){
  var flag=false;
  document.body.onclick=function(){flag=true;}
  document.body.onkeydown=function(){flag=true;}
  var canvas=document.getElementById("webglcanvas");
  canvas.style.position='absolute';
  canvas.style.left=canvas.style.top=0;
  GL=canvas.getContext("experimental-webgl");
  GL.framebuffer=new FrameBufferObject();
  var renderTarget;
  window.onresize=function(){
    canvas.width=innerWidth;
    canvas.height=innerHeight;
    renderTarget = new RenderTarget({width: canvas.width, height: canvas.width,x:0,y:-(canvas.width-canvas.height)/2});
    GL.framebuffer.setRenderTarget(renderTarget);
  }
  window.onresize();
  GL.clearColor(0,0,0,1)
  GL.clear(GL.COLOR_BUFFER_BIT);
  GL.disable(GL.DEPTH_TEST);
  GL.enable(GL.BLEND);
  var effect1 = new LifeGame('effects/lifegame/');
  var effect2 = new BlurEffect('effects/blur/');
  var effect3 = new SquareEffect('aftereffect/square/');
  var effect4 = new SugokuEffect('aftereffect/sugokuiine/');
  effect1.render(renderTarget,1);
  effect2.render(renderTarget,1);
  var t=new Date();
  setInterval(function(){
    GL.clear(GL.COLOR_BUFFER_BIT);
    GL.blendFunc(GL.ONE,GL.ZERO);
    if(flag&&(new Date()-1000/10>t)){
      effect1.render(renderTarget,1);
      effect2.render(renderTarget,1);
      flag=false;
      t=new Date();
    }else{
      effect1.render(renderTarget,0);
      effect2.render(renderTarget,0);
    }
    effect3.render(renderTarget);
    effect4.render(renderTarget);
  },10)
}





</script>
<canvas id=webglcanvas width=1024 height=512></canvas>
